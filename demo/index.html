<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>AI Text Enhancer Demo</title>

    <!-- TinyMCE -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tinymce/6.7.0/tinymce.min.js"></script>

    <!-- Estilos de demostraci√≥n -->
    <style>
      body {
        font-family: system-ui, -apple-system, sans-serif;
        max-width: 1200px;
        margin: 0 auto;
        padding: 20px;
      }

      .container {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(500px, 1fr));
        gap: 20px;
        margin-bottom: 40px;
      }

      .editor-container {
        padding: 20px;
        border: 1px solid #e5e7eb;
        border-radius: 8px;
      }

      .editor-container h2 {
        margin-top: 0;
        margin-bottom: 20px;
        color: #1f2937;
      }

      textarea {
        width: 100%;
        height: 300px;
        padding: 12px;
        border: 1px solid #d1d5db;
        border-radius: 6px;
        font-family: inherit;
        font-size: 0.875rem;
        line-height: 1.5;
        resize: vertical;
        box-sizing: border-box;
      }

      .controls {
        margin-top: 20px;
        display: flex;
        gap: 10px;
      }

      button {
        padding: 8px 16px;
        border: none;
        border-radius: 6px;
        background: #3b82f6;
        color: white;
        cursor: pointer;
        font-size: 14px;
      }

      button:hover {
        background: #2563eb;
      }

      .api-key-form {
        margin-bottom: 20px;
        padding: 20px;
        background: #f9fafb;
        border-radius: 8px;
      }

      .api-key-form input {
        padding: 8px 12px;
        border: 1px solid #d1d5db;
        border-radius: 6px;
        width: 300px;
        margin-right: 10px;
      }

      /* BOTON IA */
      .center {
        display: flex;
        flex: 1;
        height: 100%;
        align-items: center;
        justify-content: center;
      }

      #box {
        position: relative;
        display: flex;
        align-items: center;
        justify-content: center;
        padding: 0.9em;
        background: #fff;
        border-radius: 2em;
        box-shadow: 0 1px 3px 1px rgba(0, 0, 0, 0.25);
        cursor: pointer;
        transition: box-shadow 250ms ease-in-out;
        font-family: sans-serif;
        font-weight: bold;
        background-image: linear-gradient(
          to right,
          #da22ff 0%,
          #9733ee 51%,
          #da22ff 100%
        );
        color: white;
        text-shadow: 1px 1px 2px #9733ee;

        &:hover {
          box-shadow: 0 1px 3px 1px rgba(0, 0, 0, 0.1);

          &:before {
            width: 100%;
            height: 100%;
            filter: blur(0.5em);
            opacity: 1;
          }
        }

        &:before {
          content: "";
          opacity: 0;
          position: absolute;
          left: 0;
          top: 0;
          background: linear-gradient(
            45deg,
            #fb0094,
            #0000ff,
            #00ff00,
            #ffff00,
            #ff0000
          );
          background-size: 200%;
          width: 100%;
          height: 100%;
          border-radius: 10em;
          z-index: -1;
          animation: ai-button-glow 5s linear infinite;
          transition: filter 250ms ease-in-out, opacity 250ms ease-in-out;
        }

        svg {
          margin-right: 0.5em;
          height: 1em;
        }
      }

      @keyframes ai-button-glow {
        0% {
          background-position: 0 0;
        }

        50% {
          background-position: 200% 0;
        }

        100% {
          background-position: 0 0;
        }
      }

      @keyframes pulse {
        0% {
          filter: blur(0);
        }

        50% {
          filter: blur(0.5em);
        }

        100% {
          filter: blur(0);
        }
      }
    </style>
  </head>
  <body>
    <h1>AI Text Enhancer Demo</h1>

    <!-- API Key Form -->
    <div class="api-key-form">
      <label for="api-key">OpenAI API Key:</label>
      <input type="password" id="api-key" placeholder="sk-..." />
      <button onclick="updateApiKeys()">Actualizar API Key</button>
    </div>

    <div class="container">
      <!-- TinyMCE Editor -->
      <div class="editor-container">
        <h2>Editor TinyMCE</h2>
        <div id="tinymce-editor"></div>
        <ai-text-enhancer
          id="tinymce-enhancer"
          editor-id="tinymce-editor"
          api-provider="openai"
          api-model="gpt-4"
        >
          ></ai-text-enhancer
        >
      </div>

      <!-- Textarea normal -->
      <div class="editor-container">
        <h2>Textarea Normal</h2>
        <textarea
          id="simple-editor"
          placeholder="Escribe o pega tu texto aqu√≠..."
        >
Este es un ejemplo de descripci√≥n de producto que se puede mejorar usando IA.

El producto es resistente y duradero, hecho con buenos materiales. Tiene varias funciones √∫tiles y es f√°cil de usar. Viene en diferentes colores y tama√±os para adaptarse a tus necesidades.

Es una buena opci√≥n para quien busque calidad a buen precio.</textarea
        >
        <ai-text-enhancer
          id="simple-enhancer"
          editor-id="simple-editor"
          api-provider="openai"
          api-model="gpt-4"
        >
          ></ai-text-enhancer
        >
      </div>
    </div>

    <div class="center">
      <div id="box">
        <svg
          xmlns="http://www.w3.org/2000/svg"
          width="24"
          height="24"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          stroke-width="2"
          stroke-linecap="round"
          stroke-linejoin="round"
          class="lucide lucide-wand-sparkles"
        >
          <path
            d="m21.64 3.64-1.28-1.28a1.21 1.21 0 0 0-1.72 0L2.36 18.64a1.21 1.21 0 0 0 0 1.72l1.28 1.28a1.2 1.2 0 0 0 1.72 0L21.64 5.36a1.2 1.2 0 0 0 0-1.72"
          />
          <path d="m14 7 3 3" />
          <path d="M5 6v4" />
          <path d="M19 14v4" />
          <path d="M10 2v2" />
          <path d="M7 8H3" />
          <path d="M21 16h-4" />
          <path d="M11 3H9" />
        </svg>
        <span> Mejorar con IA</span>
      </div>
    </div>

    <!-- Script para updateApiKeys -->
    <script>
      window.updateApiKeys = async function () {
        console.log("üîÑ updateApiKeys called");
        const apiKey = document.getElementById("api-key").value;
        console.log("üîë API Key length:", apiKey.length);

        if (!apiKey) {
          console.error("‚ùå API Key is empty");
          return;
        }

        const enhancers = document.querySelectorAll("ai-text-enhancer");
        console.log(`üìù Found ${enhancers.length} enhancers`);

        try {
          for (let i = 0; i < enhancers.length; i++) {
            const enhancer = enhancers[i];
            console.log(`üîÑ Processing enhancer ${i + 1}`);

            // Esperar a que el componente est√© listo
            if (!enhancer.isInitialized) {
              console.log(`‚è≥ Waiting for enhancer ${i + 1} to initialize`);
              await new Promise((resolve) => {
                const checkInterval = setInterval(() => {
                  if (enhancer.isInitialized) {
                    clearInterval(checkInterval);
                    console.log(`‚úÖ Enhancer ${i + 1} initialized`);
                    resolve();
                  }
                }, 100);
              });
            }

            console.log(`üîë Setting API Key for enhancer ${i + 1}`);
            enhancer.setAttribute("api-key", apiKey);
            console.log(`‚úÖ API Key set for enhancer ${i + 1}`);
          }

          console.log("‚úÖ All API keys updated successfully");
        } catch (error) {
          console.error("‚ùå Error updating API keys:", error);
        }
      };
    </script>

    <!-- Importar el componente -->
    <script type="module">
      // Esperar a que el DOM est√© listo
      document.addEventListener("DOMContentLoaded", async () => {
        try {
          // Importar el componente
          await import("../src/ai-text-enhancer.js");

          // Inicializar TinyMCE
          tinymce.init({
            selector: "#tinymce-editor",
            height: 300,
            menubar: false,
            plugins: [
              "advlist",
              "autolink",
              "lists",
              "link",
              "image",
              "charmap",
              "preview",
              "anchor",
              "searchreplace",
              "visualblocks",
              "code",
              "fullscreen",
              "insertdatetime",
              "media",
              "table",
              "help",
              "wordcount",
            ],
            toolbar:
              "undo redo | blocks | bold italic forecolor | alignleft aligncenter " +
              "alignright alignjustify | bullist numlist outdent indent | " +
              "removeformat | help",
            content_style:
              "body { font-family:Helvetica,Arial,sans-serif; font-size:14px }",
            setup: function (editor) {
              editor.on("init", function () {
                editor.setContent(
                  "Este es un ejemplo de descripci√≥n en TinyMCE que se puede mejorar usando IA."
                );
              });
            },
          });
        } catch (error) {
          console.error("Error inicializando el componente:", error);
        }
      });
    </script>
  </body>
</html>
